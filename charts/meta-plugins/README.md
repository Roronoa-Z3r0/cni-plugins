# plugins

![Version: 0.1.6](https://img.shields.io/badge/Version-v0.1.6-informational?style=flat-square) ![Type: application](https://img.shields.io/badge/Type-application-informational?style=flat-square) ![AppVersion: 0.1.6](https://img.shields.io/badge/AppVersion-0.1.6-informational?style=flat-square)

Plugins works with macvlan cni to solve some communication problems when macvlan is used as CNI.

## Maintainers

| Name | Email | Url |
| ---- | ------ | --- |
| Spider-Guys |  |  |

## Source Code

* <https://github.com/spidernet-io/cni-plugins>

## Values

| Key | Type | Default | Description |
|-----|------|---------|-------------|
| affinity | object | `{}` |  |
| fullnameOverride | string | `""` |  |
| image.pullPolicy | string | `"IfNotPresent"` |  |
| image.repository | string | `"ghcr.io/spidernet-io/cni-plugins/veth"` |  |
| image.tag | string | `""` |  |
| imagePullSecrets | list | `[]` |  |
| nameOverride | string | `""` |  |
| nodeSelector."kubernetes.io/arch" | string | `"amd64"` |  |
| podAnnotations | object | `{}` |  |
| resources | object | `{}` |  |
| tolerations | list | `[]` |  |

## Quick Install

```shell
helm repo add cni-meta-plugins https://spidernet-io.github.io/cni-plugins
helm install meta-meta-plugins cni-meta-plugins/meta-meta-plugins -n kube-system 
```

By default, the image's tag is consistent with the Chart version, if you want to specify the image's tag, you can follow the command below:

```shell
helm install cni-meta-plugins/veth -n kube-system . \
--set image.tag=v0.1.6
```

-----------------------------
Autogenerated from chart metadata using [helm-docs v1.11.0](https://github.com/norwoodj/helm-docs/releases/v1.11.0)

## Examples

Multus Net-Atta-Def CRD examples:

- Macvlan-standalone

```shell
apiVersion: "k8s.cni.cncf.io/v1"
kind: NetworkAttachmentDefinition
metadata:
  name: macvlan-standalone
  namespace: kube-system
spec:
  config: |-
    {
        "cniVersion": "0.3.1",
        "name": "macvlan-standalone",
        "plugins": [
            {
                "type": "macvlan",
                "master": "ens192",  # macvlan master insterface
                "mode": "bridge",
                "ipam": {
                    "type": "spiderpool",
                    "log_level": "DEBUG",
                    "log_file_path": "/var/log/spidernet/spiderpool.log",
                    "log_file_max_size": 100,
                    "log_file_max_age": 30,
                    "log_file_max_count": 10
                }
            },{
                "type": "veth",
                "routes": [{"dst": "10.244.0.0/18"},{"dst": "10.244.64.0/18"}], # calico/service subnet
                "rp_filter": {
                    "set_host": true,
                    "value": 2
                },
                "skip_call": false
            }
        ]
    }

```

- Macvlan-overlay

Calico + Macvlan:

```shell
apiVersion: "k8s.cni.cncf.io/v1"
kind: NetworkAttachmentDefinition
metadata:
  name: macvlan-overlay
  namespace: kube-system
spec:
  config: |-
    {
        "cniVersion": "0.3.1",
        "name": "macvlan-overlay",
        "plugins": [
            {
                "type": "macvlan",
                "master": "ens192",
                "mode": "bridge",
                "ipam": {
                    "type": "spiderpool",
                    "log_level": "DEBUG",
                    "log_file_path": "/var/log/spidernet/spiderpool.log",
                    "log_file_max_size": 100,
                    "log_file_max_age": 30,
                    "log_file_max_count": 10
                }
            },{
                "type": "router",
                "routes": [{"dst": "10.244.0.0/18"},{"dst": "10.244.64.0/18"}], # service/calico subnet
                "rp_filter": {
                    "set_host": true,
                    "value": 2
                },
                 "hijack_overlay_reponse": true,
                "defaultOverlayInterface": eth0,
                "skip_call": false
            }
        ]
    }

```

## Notice 
